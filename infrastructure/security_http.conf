# ────────────────────────────────────────────────────────────
# /etc/nginx/snippets/security_http.conf
# Global HTTP-level settings
# (include this inside http { … })
# ────────────────────────────────────────────────────────────

# Client buffer tuning
client_body_buffer_size     128k;
client_header_buffer_size   1k;
large_client_header_buffers 4 4k;

# Extra security headers (DISABLED - Cloudflare handles this)
# add_header X-XSS-Protection "1; mode=block" always;

# 1) Request size limit
client_max_body_size 10m;

# 2) Define rate-limit zones (DISABLED - Cloudflare handles this better)
#    "api"     → for API endpoints (30r/s - more lenient)
#    "admin"   → for admin UI (10r/s - more lenient)  
#    "general" → for regular page views (50r/s - very lenient)
# limit_req_zone   $binary_remote_addr  zone=api:10m     rate=30r/s;
# limit_req_zone   $binary_remote_addr  zone=admin:10m   rate=10r/s;
# limit_req_zone   $binary_remote_addr  zone=general:10m rate=50r/s;
# limit_conn_zone  $binary_remote_addr  zone=addr:10m;

# 3) Global security headers (DISABLED - Cloudflare handles this)
# add_header X-Frame-Options         "SAMEORIGIN"                 always;
# add_header X-Content-Type-Options  "nosniff"                    always;
# add_header Referrer-Policy         "no-referrer-when-downgrade" always;
# add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
# add_header Content-Security-Policy "default-src 'self';"       always;

# ────────────────────────────────────────────────────────────
# Content Security Policy
# ────────────────────────────────────────────────────────────
#add_header Content-Security-Policy "
#    default-src 'self';
#    script-src  'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com;
#    style-src   'self' 'unsafe-inline'
#                 https://cdn.jsdelivr.net
#                 https://fonts.googleapis.com
#                 https://cdnjs.cloudflare.com;
#    style-src-elem
#                'self'
#                https://cdn.jsdelivr.net
#                https://fonts.googleapis.com
#                https://cdnjs.cloudflare.com;
#    font-src    'self' https://fonts.gstatic.com;
#    img-src     'self' data:;
#    connect-src 'self';
#" always;
